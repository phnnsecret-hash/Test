local Players = game:GetService("Players")
local TeleportService = game:GetService("TeleportService")
local HttpService = game:GetService("HttpService")

local PLACE_ID = game.PlaceId
local JOB_ID = game.JobId
local TARGET_MOVESET = "Mokou"

local function hasTarget()
    local chars = workspace:FindFirstChild("Characters")
    if not chars then return false end
    local playersFolder = chars:FindFirstChild("Oyuncular")
    if not playersFolder then return false end
    for _, model in ipairs(playersFolder:GetChildren()) do
        if model:IsA("Model") and model:GetAttribute("Moveset") == TARGET_MOVESET then
            return true
        end
    end
    return false
end

local function getServers()
    local servers = {}
    local cursor = nil

    repeat
        local url = "https://games.roblox.com/v1/games/" .. PLACE_ID .. "/servers/Public?sortOrder=Desc&limit=100&excludeFullGames=true"
        if cursor then
            url = url .. "&cursor=" .. cursor
        end

        local success, req = pcall(function()
            return game:HttpGet(url)
        end)

        if success and req then
            local body
            local ok = pcall(function()
                body = HttpService:JSONDecode(req)
            end)

            if ok and body and body.data then
                for _, v in ipairs(body.data) do
                    if type(v) == "table"
                    and tonumber(v.playing)
                    and tonumber(v.maxPlayers)
                    and v.playing < v.maxPlayers
                    and v.id ~= JOB_ID then
                        table.insert(servers, v.id)
                    end
                end
                cursor = body.nextPageCursor
            else
                cursor = nil
            end
        else
            cursor = nil
        end

        task.wait(0.15)
    until not cursor

    return servers
end

local function ServerHop()
    local servers = getServers()
    if #servers > 0 then
        queue_on_teleport([[
            loadstring(game:HttpGet("https://raw.githubusercontent.com/phnnsecret-hash/Test/refs/heads/main/test"))()
        ]])
        TeleportService:TeleportToPlaceInstance(
            PLACE_ID,
            servers[math.random(1, #servers)],
            Players.LocalPlayer
        )
    end
end

while task.wait(2) do
    if hasTarget() then
        break
    else
        ServerHop()
        break
    end
end
